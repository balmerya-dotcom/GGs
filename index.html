<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Urban Assault FPS</title>
<style>
body { margin:0; overflow:hidden; background:#222; font-family:Arial; }
#menu {
 position:absolute;
 width:100%;
 height:100%;
 background:black;
 color:white;
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
}
button {
 padding:15px 40px;
 font-size:22px;
 cursor:pointer;
}
#hud {
 position:absolute;
 top:10px;
 left:10px;
 color:white;
}
#crosshair {
 position:absolute;
 top:50%;
 left:50%;
 width:20px;
 height:20px;
 margin-left:-10px;
 margin-top:-10px;
 border:2px solid white;
}
canvas { display:block; }
</style>
</head>
<body>

<div id="menu">
<h1>Urban Assault</h1>
<button onclick="startGame()">Start Game</button>
</div>

<div id="hud"></div>
<div id="crosshair"></div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gameStarted = false;
let player = {x: canvas.width/2, y: canvas.height/2, health:100, vy:0, jumping:false};
let keys = {};
let enemies = [];
let level = 1;
let score = 0;

let weapon="pistol";
let ammo=5;
let maxAmmo=5;
let reloading=false;

function startGame(){
 document.getElementById("menu").style.display="none";
 gameStarted=true;
 spawnEnemies();
 requestAnimationFrame(gameLoop);
}

function spawnEnemies(){
 enemies=[];
 for(let i=0;i<level*4;i++){
   enemies.push({
     x:Math.random()*canvas.width,
     y:Math.random()*canvas.height,
     health:50
   });
 }
}

function drawCity(){
 ctx.fillStyle="#333";
 ctx.fillRect(0,canvas.height-100,canvas.width,100);
 ctx.fillStyle="#444";
 for(let i=0;i<20;i++){
   ctx.fillRect(i*200,canvas.height-300,120,200);
 }
}

function drawPlayer(){
 ctx.fillStyle="blue";
 ctx.fillRect(player.x-10,player.y-10,20,20);
}

function drawEnemies(){
 ctx.fillStyle="red";
 enemies.forEach(e=>{
   ctx.fillRect(e.x-15,e.y-15,30,30);
 });
}

function movePlayer(){
 if(keys["w"]) player.y-=2;
 if(keys["s"]) player.y+=2;
 if(keys["a"]) player.x-=2;
 if(keys["d"]) player.x+=2;

 if(keys[" "] && !player.jumping){
   player.vy=-10;
   player.jumping=true;
 }

 player.y+=player.vy;
 player.vy+=0.5;

 if(player.y>=canvas.height-110){
   player.y=canvas.height-110;
   player.jumping=false;
   player.vy=0;
 }
}

function shoot(){
 if(reloading||ammo<=0)return;
 ammo--;
 enemies.forEach(e=>{
   e.health-=(weapon==="pistol")?5:2;
 });
 enemies=enemies.filter(e=>e.health>0);
 score+=10;
 checkLevel();
}

function throwGrenade(){
 enemies.forEach(e=>{
   let dx=e.x-player.x;
   let dy=e.y-player.y;
   let dist=Math.sqrt(dx*dx+dy*dy);
   if(dist<150){
     let damage=Math.floor(150-dist)/10;
     e.health-=damage;
   }
 });
 enemies=enemies.filter(e=>e.health>0);
 score+=20;
 checkLevel();
}

function reload(){
 if(reloading)return;
 reloading=true;
 setTimeout(()=>{
   ammo=maxAmmo;
   reloading=false;
 },1000);
}

function checkLevel(){
 if(enemies.length===0){
   level++;
   spawnEnemies();
 }
}

document.addEventListener("keydown",e=>{
 keys[e.key.toLowerCase()]=true;

 if(e.key==="1"){weapon="pistol";maxAmmo=5;ammo=5;}
 if(e.key==="2"){weapon="rifle";maxAmmo=30;ammo=30;}
 if(e.key==="3"){throwGrenade();}
 if(e.key==="r"){reload();}
});

document.addEventListener("keyup",e=>{
 keys[e.key.toLowerCase()]=false;
});

document.addEventListener("click",shoot);

function gameLoop(){
 if(!gameStarted)return;
 ctx.clearRect(0,0,canvas.width,canvas.height);

 drawCity();
 movePlayer();
 drawPlayer();
 drawEnemies();

 document.getElementById("hud").innerHTML=
 "Health: "+player.health+
 " | Ammo: "+ammo+
 " | Weapon: "+weapon+
 " | Score: "+score+
 " | Level: "+level;

 requestAnimationFrame(gameLoop);
}
</script>

</body>
</html>
